<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Youtube Videos</title>    
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="js/aframe-websurfaces-custom.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/hiukim/mind-ar-js@1.1.5/dist/mindar-image.prod.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/hiukim/mind-ar-js@1.1.5/dist/mindar-image-aframe.prod.js"></script>
    <link rel="stylesheet" href="css/style.css">
    <script>
        AFRAME.registerComponent("world2local", {
            tick: function () {
                var worldToLocal = new THREE.Matrix4();
                var scene = document.querySelector("a-scene");
                worldToLocal.copy(this.el.object3D.matrixWorld).invert();
                scene.object3D.applyMatrix4(worldToLocal);
            },
        });
    </script>
</head>

<body>
    <div id="buttons">
        <button id="playButton">
            Play
        </button>
        <button id="pauseButton">
            Pause
        </button>
        <button id="stopButton">
            Stop
        </button>
    </div>
    <div id="sensorPrompt">
        <button id="requestAccess">Enable AR Experience</button>
      </div>
    <a-scene
        mindar-image="imageTargetSrc: ./targets.mind; filterMinCF:0.001; filterBeta: 10"
        vr-mode-ui="enabled: false">
       <!--  <a-assets>
            <video id="video" src="./img/Reelvideo-59543.mp4"></video>
        </a-assets> -->
        <a-camera position="0 0 0" look-controls="enabled: false; pointerLockEnabled: false" device-orientation-permission-ui="enabled: false"></a-camera>
        <a-entity id="example-target" mindar-image-target="targetIndex: 0">
            <a-entity id="myVid" world2local class="clickable"
                websurface="url:https://www.youtube.com/embed/dQw4w9WgXcQ&rel=0; width:3.5; height:2.0;" position="0 0 0">
            </a-entity>

          <!--   <a-video src="#video" width="1.5" height="2" position="0 0 0"></a-video> -->
        </a-entity>
    </a-scene>
</body>

<script>
    // Function to check if the device is iOS
    function isIOS() {
      return /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
    }
  
    document.getElementById("requestAccess").addEventListener("click", function () {
      // Only request motion sensor access on iOS devices
      if (isIOS()) {
        if (typeof DeviceMotionEvent !== 'undefined' && typeof DeviceMotionEvent.requestPermission === 'function') {
          // iOS 13+ specific code
          DeviceMotionEvent.requestPermission()
            .then(permissionState => {
              if (permissionState === 'granted') {
                console.log("Device motion access granted!");
                // Hide the prompt and start the AR experience
                document.getElementById("sensorPrompt").style.display = "none";
              } else {
                alert("Device motion access denied. This AR experience may not work correctly.");
              }
            })
            .catch(console.error);
        } else {
          alert("Your iOS device doesn't support motion sensor access.");
        }
      } else {
        // Hide the prompt if not iOS, and allow the AR experience to start
        document.getElementById("sensorPrompt").style.display = "none";
      }
    });
  </script>

<script src="js/main.js"></script>

</html>
